# Data fetching and Mock Server

## REST API

Each demo page gets its data by using `getStaticProps` function;

For example market-1.tsx fetching data in its
`getStaticProps` function. This function uses REST api to get data. HTTP calls are made in `__server__/__api__/market-1` file.

`axios` is used for calling the api, you can use any library you want.

### API Function

```ts
// __server__/__api__/

const recentPurchase = async () => {
  const response = await axios.get('/api/recent-purchase')
  return response.data
}
```

### API Function Call from Client Side

```ts
import api from '__server__/__api__/grocery1-shop'

export async function getStaticProps() {
  const popularProducts = await api.getPopularProducts()

  return {
    props: { popularProducts },
  }
}
```

## Mock server

### Note

- We use mock server for demo purpose. You need to remove this from the template.
- Remove the import from **pages/\_app.tsx**

```ts
// _app.tsx
// Remove this import
import '../src/__server__'
```

### Fake API example

```ts
// src/__server__/__db__/market-2/index.ts

// get all categories
Mock.onGet('/api/market-2/category').reply(() => {
  try {
    return [200, db.categories]
  } catch (err) {
    console.error(err)
    return [500, { message: 'Internal server error' }]
  }
})
```
